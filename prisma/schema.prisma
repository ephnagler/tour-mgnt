datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id    String @id @default(cuid())
  email String @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  password Password?
  // notes    Note[]
}

model Password {
  hash String

  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  userId String @unique
}

// model Note {
//   id    String @id @default(cuid())
//   title String
//   body  String

//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt

//   user   User   @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
//   userId String
// }

model Daysheet {
  id           String     @id @default(cuid())
  slug         String     @unique
  date         DateTime   @default(now())
  venue        Venue      @relation(fields: [venueId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  venueId      String     @unique
  hotel        Hotel      @relation(fields: [hotelId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  hotelId      String     @unique
  contacts     Contact[]
  guests       Guest[]
  guestsLimit  Int        @default(20)
  buyOut       Boolean    @default(false)
  buyOutAmount Int        @default(0)
  buyOutAlt    String     @default("Dinner Provided")
  schedules    Schedule[]
  mapIn        String
  mapOut       String
}

model Venue {
  id        String    @id @default(cuid())
  slug      String    @unique
  name      String
  address   Address   @relation(fields: [addressId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  addressId String    @unique
  contacts  Contact[]
  daysheet  Daysheet?
}

model Hotel {
  id        String    @id @default(cuid())
  slug      String    @unique
  name      String
  address   Address   @relation(fields: [addressId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  addressId String    @unique
  daysheet  Daysheet?
}

model Address {
  id     String @id @default(cuid())
  slug   String @unique
  name   String
  street String
  city   String
  state  String
  zip    String
  phone  String
  email  String
  venue  Venue?
  hotel  Hotel?
}

model Contact {
  id         String    @id @default(cuid())
  slug       String    @unique
  name       String
  phone      String
  email      String
  venue      Venue?    @relation(fields: [venueId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  venueId    String    @unique
  daysheet   Daysheet? @relation(fields: [daysheetId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  daysheetId String    @unique
}

model Guest {
  id         String    @id @default(cuid())
  slug       String    @unique
  name       String
  party      Int       @default(0)
  daysheet   Daysheet? @relation(fields: [daysheetId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  daysheetId String    @unique
}

model Schedule {
  id         String    @id @default(cuid())
  slug       String    @unique
  name       String
  timeFrom   DateTime  @default(now())
  timeTo     DateTime  @default(now())
  daysheet   Daysheet? @relation(fields: [daysheetId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  daysheetId String    @unique
}
